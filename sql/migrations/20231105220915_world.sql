DROP PROCEDURE IF EXISTS add_migration;
delimiter ??
CREATE PROCEDURE `add_migration`()
BEGIN
DECLARE v INT DEFAULT 1;
SET v = (SELECT COUNT(*) FROM `migrations` WHERE `id`='20231105220915');
IF v=0 THEN
INSERT INTO `migrations` VALUES ('20231105220915');
-- Add your query below.


-- Pathing for Forsaken Courier Entry: 2714
SET @NPC := 2714;
UPDATE `creature` SET `spawntimesecsmin`=300, `position_x`=-1552.2574,`position_y`=-3034.5396,`position_z`=13.729361, `orientation`=5.058968544006347656 WHERE `guid`=14772; -- CreateObject2
DELETE FROM `creature_movement_template` WHERE `entry`=@NPC;
INSERT INTO `creature_movement_template` (`entry`,`point`,`position_x`,`position_y`,`position_z`,`orientation`,`waittime`,`wander_distance`,`script_id`) VALUES
(@NPC,1,-1550.5396,-3063.7197,13.153982,100,0,0,0),
(@NPC,2,-1559.3317,-3069.132,13.224138,100,0,0,0),
(@NPC,3,-1574.5154,-3064.1624,13.014132,100,0,0,0),
(@NPC,4,-1596.2856,-3052.2166,13.811936,100,0,0,0),
(@NPC,5,-1627.7938,-3019.7805,17.626093,100,0,0,0),
(@NPC,6,-1644.7137,-2996.7366,22.271368,100,0,0,0),
(@NPC,7,-1647.0454,-2974.612,26.206776,100,0,0,0),
(@NPC,8,-1638.745,-2943.9448,28.510544,100,0,0,0),
(@NPC,9,-1637.8221,-2930.4207,28.01085,100,0,0,0),
(@NPC,10,-1644.2511,-2905.6404,26.343475,100,0,0,0),
(@NPC,11,-1641.7524,-2893.7244,26.690807,100,0,0,0),
(@NPC,12,-1629.529,-2859.1594,31.17086,100,0,0,0),
(@NPC,13,-1621.3707,-2823.1963,33.605366,100,0,0,0),
(@NPC,14,-1614.7848,-2787.255,35.600468,100,0,0,0),
(@NPC,15,-1612.2305,-2775.537,36.257774,100,0,0,0),
(@NPC,16,-1608.7706,-2745.1785,37.629112,100,0,0,0),
(@NPC,17,-1600.5686,-2727.4854,37.2911,100,0,0,0),
(@NPC,18,-1582.5442,-2705.3542,35.535637,100,0,0,0),
(@NPC,19,-1564.3455,-2686.7476,35.313774,100,0,0,0),
(@NPC,20,-1557.4377,-2663.8599,37.181084,100,0,0,0),
(@NPC,21,-1555.9431,-2640.7454,41.40903,100,0,0,0),
(@NPC,22,-1556.6326,-2616.0356,45.968483,100,0,0,0),
(@NPC,23,-1557.4188,-2604.809,47.80564,100,0,0,0),
(@NPC,24,-1565.931,-2580.6577,48.851364,100,0,0,0),
(@NPC,25,-1568.0028,-2557.4568,50.167168,100,0,0,0),
(@NPC,26,-1566.4523,-2541.855,51.137238,100,0,0,0),
(@NPC,27,-1555.2555,-2516.8293,53.243954,100,0,0,0),
(@NPC,28,-1549.1812,-2503.7979,54.04501,100,0,0,0),
(@NPC,29,-1547.7216,-2496.8203,54.32717,100,0,0,0),
(@NPC,30,-1527.9796,-2481.2585,53.451958,100,0,0,0),
(@NPC,31,-1503.3694,-2460.545,52.967335,100,0,0,0),
(@NPC,32,-1473.5493,-2434.7302,56.466362,100,0,0,0),
(@NPC,33,-1458.8331,-2421.2942,58.656948,100,0,0,0),
(@NPC,34,-1452.3053,-2402.9504,60.67887,100,0,0,0),
(@NPC,35,-1450.1532,-2373.218,61.44899,100,0,0,0),
(@NPC,36,-1451.1536,-2340.4387,61.64101,100,0,0,0),
(@NPC,37,-1450.4178,-2302.2532,61.781944,100,0,0,0),
(@NPC,38,-1446.4645,-2283.9849,62.001453,100,0,0,0),
(@NPC,39,-1429.0787,-2259.9133,63.329742,100,0,0,0),
(@NPC,40,-1413.9623,-2238.0234,63.76512,100,0,0,0),
(@NPC,41,-1405.9896,-2213.4133,63.83678,100,0,0,0),
(@NPC,42,-1397.8019,-2179.22,63.975334,100,0,0,0),
(@NPC,43,-1394.8337,-2157.2942,64.12083,100,0,0,0),
(@NPC,44,-1389.1965,-2130.726,64.30086,100,0,0,0),
(@NPC,45,-1386.084,-2093.0955,63.538784,100,0,0,0),
(@NPC,46,-1382.9713,-2064.3916,62.196663,100,0,0,0),
(@NPC,47,-1381.2926,-2024.9727,60.49669,100,0,0,0),
(@NPC,48,-1378.0903,-1991.1364,58.87672,100,0,0,0),
(@NPC,49,-1372.9749,-1969.6237,58.4894,100,0,0,0),
(@NPC,50,-1358.9327,-1937.6272,58.429527,100,0,0,0),
(@NPC,51,-1345.5436,-1900.9165,58.88335,100,0,0,0),
(@NPC,52,-1334.4801,-1873.9283,61.046577,100,0,0,0),
(@NPC,53,-1326.9805,-1844.8652,62.919468,100,0,0,0),
(@NPC,54,-1317.9423,-1828.1803,64.2181,100,0,0,0),
(@NPC,55,-1305.6846,-1814.4705,65.43024,100,0,0,0),
(@NPC,56,-1287.2552,-1802.0076,66.81915,100,0,0,0),
(@NPC,57,-1268.3904,-1790.3546,66.98339,100,0,0,0),
(@NPC,58,-1247.4291,-1780.4617,65.617584,100,0,0,0),
(@NPC,59,-1226.9957,-1765.1711,62.542084,100,0,0,0),
(@NPC,60,-1204.1685,-1744.7555,58.50273,100,0,0,0),
(@NPC,61,-1184.8517,-1727.0286,55.7396,100,0,0,0),
(@NPC,62,-1161.4525,-1714.4059,52.467422,100,0,0,0),
(@NPC,63,-1128.6226,-1704.3712,46.72372,100,0,0,0),
(@NPC,64,-1104.1973,-1697.0764,43.87498,100,0,0,0),
(@NPC,65,-1066.6626,-1687.9126,38.52332,100,0,0,0),
(@NPC,66,-1031.4158,-1685.6598,36.75798,100,0,0,0),
(@NPC,67,-989.87,-1685.7096,37.153557,100,0,0,0),
(@NPC,68,-954.4911,-1679.9586,39.846252,100,0,0,0),
(@NPC,69,-935.4559,-1673.2611,42.302216,100,0,0,0),
(@NPC,70,-904.6699,-1652.666,46.8469,100,0,0,0),
(@NPC,71,-879.7355,-1630.1259,50.646404,100,0,0,0),
(@NPC,72,-849.13745,-1600.462,53.653923,100,0,0,0),
(@NPC,73,-823.2393,-1568.6105,54.16692,100,0,0,0),
(@NPC,74,-803.49115,-1541.2704,54.32366,100,0,0,0),
(@NPC,75,-785.0775,-1514.2242,56.51477,100,0,0,0),
(@NPC,76,-774.65625,-1493.6953,59.338264,100,0,0,0),
(@NPC,77,-767.2293,-1466.985,63.069607,100,0,0,0),
(@NPC,78,-752.73285,-1436.9225,66.09219,100,0,0,0),
(@NPC,79,-739.00226,-1409.3284,67.84255,100,0,0,0),
(@NPC,80,-718.06006,-1383.163,68.17649,100,0,0,0),
(@NPC,81,-698.65546,-1354.9768,67.62379,100,0,0,0),
(@NPC,82,-668.78784,-1320.2452,66.49698,100,0,0,0),
(@NPC,83,-651.63995,-1292.4681,66.0947,100,0,0,0),
(@NPC,84,-639.0124,-1269.6914,66.09687,100,0,0,0),
(@NPC,85,-624.9419,-1245.1007,66.08201,100,0,0,0),
(@NPC,86,-612.69714,-1217.49,65.970436,100,0,0,0),
(@NPC,87,-600.3661,-1192.806,66.05884,100,0,0,0),
(@NPC,88,-590.01715,-1164.6335,66.230606,100,0,0,0),
(@NPC,89,-583.6057,-1143.0211,66.158844,100,0,0,0),
(@NPC,90,-574.55566,-1119.452,64.99346,100,0,0,0),
(@NPC,91,-561.2415,-1096.5105,60.820595,100,0,0,0),
(@NPC,92,-542.8525,-1077.1578,56.848763,100,0,0,0),
(@NPC,93,-528.6464,-1063.892,54.261414,100,0,0,0),
(@NPC,94,-511.96573,-1042.3118,49.25406,100,0,0,0),
(@NPC,95,-500.36957,-1018.0822,43.33515,100,0,0,0),
(@NPC,96,-496.20508,-992.4375,39.321293,100,0,0,0),
(@NPC,97,-491.97256,-960.6463,33.823174,100,0,0,0),
(@NPC,98,-480.21875,-916.9668,34.411404,100,0,0,0),
(@NPC,99,-466.58475,-893.22253,38.420345,100,0,0,0),
(@NPC,100,-444.16953,-865.1878,45.632973,100,0,0,0),
(@NPC,101,-424.6796,-841.2971,51.721687,100,0,0,0),
(@NPC,102,-407.0565,-818.828,53.868797,100,0,0,0),
(@NPC,103,-384.2671,-784.60156,54.59754,100,0,0,0),
(@NPC,104,-362.35455,-770.9019,54.143402,100,0,0,0),
(@NPC,105,-339.42163,-761.9837,53.706547,100,0,0,0),
(@NPC,106,-311.32858,-750.3938,54.61077,100,0,0,0),
(@NPC,107,-276.71762,-739.5008,56.650383,100,0,0,0),
(@NPC,108,-249.65782,-733.16046,58.205612,100,0,0,0),
(@NPC,109,-227.23259,-725.7258,60.692093,100,0,0,0),
(@NPC,110,-197.89236,-721.0297,62.80778,100,0,0,0),
(@NPC,111,-172.5492,-716.5685,63.705105,100,0,0,0),
(@NPC,112,-142.38582,-715.8494,64.54931,100,0,0,0),
(@NPC,113,-102.63151,-715.0204,65.735306,100,0,0,0),
(@NPC,114,-71.13481,-717.74457,67.9785,100,0,0,0),
(@NPC,115,-43.318794,-717.011,68.61642,100,0,0,0),
(@NPC,116,-25.086588,-714.46356,69.60387,100,0,0,0),
(@NPC,117,-19.629232,-718.618,69.3962,100,0,0,0),
(@NPC,118,-18.102865,-735.1451,66.66176,100,0,0,0),
(@NPC,119,-23.469294,-755.66504,63.061867,100,0,0,0),
(@NPC,120,-21.33903,-771.53516,60.74343,100,0,0,0),
(@NPC,121,-15.835612,-794.21344,59.328644,100,0,0,0),
(@NPC,122,-24.112576,-810.7386,57.798492,100,0,0,0),
(@NPC,123,-42.424915,-823.6989,57.177834,100,0,0,0),
(@NPC,124,-52.088596,-838.2867,56.467113,100,0,0,0),
(@NPC,125,-53.75716,-854.9446,56.123142,100,0,0,0),
(@NPC,126,-48.583767,-869.2076,55.545685,100,0,0,0),
(@NPC,127,-35.751953,-881.8281,56.09774,100,0,0,0),
(@NPC,128,-26.509169,-897.1533,56.041534,100,11000,0,309);
-- 0x204CB0000002A680000021000035D135 .go xyz -1550.5396 -3063.7197 13.153982

DELETE FROM `creature_movement_scripts` WHERE `id`=309;
INSERT INTO `creature_movement_scripts` (`id`, `delay`, `priority`, `command`, `datalong`, `datalong2`, `datalong3`, `datalong4`, `target_param1`, `target_param2`, `target_type`, `data_flags`, `dataint`, `dataint2`, `dataint3`, `dataint4`, `x`, `y`, `z`, `o`, `condition_id`, `comments`) VALUES
(309, 10, 0, 18, 0, 0, 0, 0, 2721, 10, 8, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 'Forsaken Courier - Despawn Nearby Bodyguard'),
(309, 10, 0, 18, 0, 0, 0, 0, 2721, 10, 8, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 'Forsaken Courier - Despawn Nearby Bodyguard'),
(309, 10, 0, 18, 0, 0, 0, 0, 2721, 10, 8, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 'Forsaken Courier - Despawn Nearby Bodyguard'),
(309, 10, 0, 18, 0, 0, 0, 0, 2721, 10, 8, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 'Forsaken Courier - Despawn Nearby Bodyguard'),
(309, 10, 1, 18, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 'Forsaken Courier - Despawn self');

-- Correct positions for Forsaken Bodyguard Entry: 2714
-- Bottom
UPDATE `creature` SET `spawntimesecsmin`=300, `position_x`=-1555.1652,`position_y`=-3046.3308,`position_z`=13.084437, `orientation`=1.329019546508789062 WHERE `guid`=14775; -- CreateObject2
-- Left
UPDATE `creature` SET `spawntimesecsmin`=300, `position_x`=-1545.0703,`position_y`=-3043.7456,`position_z`=13.569029, `orientation`=2.233138084411621093 WHERE `guid`=14773; -- CreateObject2
-- Right
UPDATE `creature` SET `spawntimesecsmin`=300, `position_x`=-1547.1117,`position_y`=-3036.405,`position_z`=13.128309, `orientation`=4.555309295654296875 WHERE `guid`=14776; -- CreateObject2
-- Top
UPDATE `creature` SET `spawntimesecsmin`=300, `position_x`=-1553.7556,`position_y`=-3040.217,`position_z`=13.138359, `orientation`=6.091198921203613281 WHERE `guid`=14774; -- CreateObject2

-- Correct formations
UPDATE `creature_groups` SET `dist`=3 WHERE `member_guid`=14774;
UPDATE `creature_groups` SET `dist`=0, `angle`=0 WHERE `member_guid`=14772;
UPDATE `creature_groups` SET `dist`=3,`angle`=1.56 WHERE `member_guid`=14773;
UPDATE `creature_groups` SET `dist`=3, `angle`=3.12 WHERE `member_guid`=14775;
UPDATE `creature_groups` SET `dist`=3, `angle`=4.68 WHERE `member_guid`=14776;


-- End of migration.
END IF;
END??
delimiter ; 
CALL add_migration();
DROP PROCEDURE IF EXISTS add_migration;
